import{d,G as ae,o as c,e as _,b as l,w as r,g as I,F as U,u as a,a as i,t as k,h as B,i as te,c as b,n as w,f as R,H as le,I as D}from"./app-f6caa0b8.js";import"./index.esm-b3ee4bca.js";import{_ as se}from"./AppLayout-c50c8568.js";import{s as ie,a as re,b as z,c as S,d as m,e as A}from"./toast.esm-7e3cf0c6.js";import{s as o}from"./button.esm-1a340f37.js";const oe=i("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Administración ",-1),ne={class:"max-w-[99.9%] m-auto p-2"},de={class:"flex flex-wrap align-items-center justify-between gap-2"},ue={class:"p-input-icon-left"},ce=i("i",{class:"pi pi-search"},null,-1),me={class:"flex justify-center gap-3 p-4 flex-wrap"},fe=["onSubmit"],ve={class:"p-field"},pe=i("label",{for:"name"},"Nombre",-1),ge={class:"p-field"},be=i("label",{for:"email"},"Correo",-1),ye={class:"p-field"},he=i("label",{for:"password"},"Contraseña",-1),Ce={class:"flex justify-end items-center max-w-[100%] mt-4 gap-4"},xe=i("div",{class:"confirmation-content flex justify-center items-center"},[i("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),i("span",null,"¿Esta seguro de eliminar los usuarios seleccionados?")],-1),_e={class:"flex justify-between mt-1"},ke=i("div",{class:"p-fluid"},[i("p",null,"¿Está seguro que desea guardar los cambios realizados?")],-1),we={class:"flex justify-between"},Me={__name:"Admin",props:{users:{type:Array,required:!0}},setup(G){let F=["Automotriz","Manufactura","Redes","LAGE","Mecatronica","Negocios","Posgrado","Sistemas","Coordinacion","Resumen","Administrador"].map(s=>({role:s})),T=["registrar","eliminar","editar"];const L="No hay registros";d(null);const y=d(!1),v=d(!1),p=d(!1),g=d(!1),f=d(),E=ae(),N=d(null),u=d([]),V=d(""),M=d(""),$=d(""),h=d({global:{value:null,matchMode:le.CONTAINS}}),q=()=>{v.value=!0},O=()=>{y.value=!0},H=s=>{const t={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};return new Date(s).toLocaleString(void 0,t)},J=(s,t)=>{u.value=[],N.value=t;for(let e of s)u.value.push(e.name);p.value=!0},C=s=>{const t=s.includes("-registrar")||s.includes("-eliminar")||s.includes("-editar");if(!u.value.includes(s)&&t){const e=s.replace("-registrar","").replace("-eliminar","").replace("-editar","");u.value.includes(e)||u.value.push(e)}u.value.includes(s)?u.value=u.value.filter(e=>e!==s):u.value.push(s)},x=s=>u.value.includes(s)?"w-full flex justify-center items-center":"w-full flex justify-center items-center opacity-50",K=()=>{const s={name:V.value,email:M.value,password:$.value};D.Inertia.post("/registrar-nuevo-usuario",s,{onSuccess:()=>{y.value=!1,E.add({severity:"success",summary:"Exito",detail:"Registrado exitosamente",life:3e3})}})},Q=()=>{const s=N.value,t={roles:u.value};D.Inertia.post(`/asignar-rol/${s}`,t,{onSuccess:()=>{E.add({severity:"success",summary:"Exito",detail:"Roles actualizados exitosamente",life:3e3})}}),p.value=!1},W=()=>{g.value=!0},X=()=>{W()},Y=()=>{g.value=!1},Z=()=>{Q(),g.value=!1},P=()=>{const s={id:f.value.map(t=>t.id)};D.Inertia.post("/eliminar-usuario",s,{preserveState:!0,preserveScroll:!0,onSuccess:()=>{v.value=!1,f.value=null,E.add({severity:"success",summary:"Exito",detail:"Eliminado Exitosamente",life:3e3})}})},ee=()=>{h.value.global.value=null};return(s,t)=>(c(),_(U,null,[l(se,{title:"Administración"},{header:r(()=>[oe,l(a(ie))]),default:r(()=>[i("div",ne,[l(a(re),{class:"mb-4"},{start:r(()=>[l(a(o),{label:"Registrar",icon:"pi pi-plus",severity:"success",class:"!mr-3",onClick:O}),l(a(o),{label:"Eliminar",icon:"pi pi-trash",severity:"danger",onClick:q,disabled:!f.value||!f.value.length},null,8,["disabled"])]),_:1}),l(a(z),{value:G.users,paginator:!0,rows:10,rowsPerPageOptions:[5,10,20],responsive:!0,filters:h.value,selection:f.value,"onUpdate:selection":t[1]||(t[1]=e=>f.value=e),emptyMessage:L,class:"p-datatable-gridlines"},{header:r(()=>[i("div",de,[i("span",ue,[ce,l(a(S),{modelValue:h.value.global.value,"onUpdate:modelValue":t[0]||(t[0]=e=>h.value.global.value=e),placeholder:"Buscar"},null,8,["modelValue"]),l(a(o),{class:"!ml-10",label:"limpiar",icon:"pi pi-trash",severity:"!ml-3",onClick:ee})])])]),default:r(()=>[l(a(m),{selectionMode:"multiple",headerStyle:"width: 3rem"}),l(a(m),{field:"id",header:"ID",sortable:"",hidden:""}),l(a(m),{field:"name",header:"Nombre",sortable:"",filter:!0,filterMatchMode:"in"}),l(a(m),{field:"email",header:"Correo",sortable:"",filter:!0,filterMatchMode:"in"}),l(a(m),{field:"created_at",header:"Fecha de creación",sortable:"",filter:!0,filterMatchMode:"in"},{body:r(e=>[I(k(H(e.data.created_at)),1)]),_:1}),l(a(m),{field:"roles",header:"Rol",sortable:""},{body:r(e=>[i("div",me,[(c(!0),_(U,null,B(e.data.roles,n=>(c(),_("span",{key:n.id,class:"p-tag p-tag-rounded p-tag-info"},k(n.name),1))),128))])]),_:1}),l(a(m),{field:"manageRoles",header:"Permisos"},{body:r(e=>[l(a(o),{label:"Editar",onClick:n=>J(e.data.roles,e.data.id)},null,8,["onClick"])]),_:1})]),_:1},8,["value","filters","selection"])]),l(a(A),{visible:y.value,"onUpdate:visible":t[5]||(t[5]=e=>y.value=e),style:{width:"650px"},header:"Registro nuevo",modal:!0,class:"p-fluid"},{default:r(()=>[i("form",{onSubmit:te(K,["prevent"])},[i("div",ve,[pe,l(a(S),{id:"name",modelValue:V.value,"onUpdate:modelValue":t[2]||(t[2]=e=>V.value=e)},null,8,["modelValue"])]),i("div",ge,[be,l(a(S),{type:"email",id:"email",modelValue:M.value,"onUpdate:modelValue":t[3]||(t[3]=e=>M.value=e)},null,8,["modelValue"])]),i("div",ye,[he,l(a(S),{type:"password",id:"password",modelValue:$.value,"onUpdate:modelValue":t[4]||(t[4]=e=>$.value=e)},null,8,["modelValue"])]),i("div",Ce,[l(a(o),{type:"submit",class:"w-auto",label:"Registrar",icon:"pi pi-check"})])],40,fe)]),_:1},8,["visible"]),l(a(A),{visible:v.value,"onUpdate:visible":t[7]||(t[7]=e=>v.value=e),style:{width:"400px"},header:"Confirmar",modal:!0},{footer:r(()=>[l(a(o),{label:"Cancelar",icon:"pi pi-times",text:"",onClick:t[6]||(t[6]=e=>v.value=!1)}),l(a(o),{label:"Eliminar",icon:"pi pi-check",text:"",onClick:P})]),default:r(()=>[xe]),_:1},8,["visible"]),l(a(A),{visible:p.value,"onUpdate:visible":t[11]||(t[11]=e=>p.value=e),header:"Editar permisos"},{footer:r(()=>[i("div",_e,[l(a(o),{label:"Cancelar",icon:"pi pi-times",onClick:t[10]||(t[10]=e=>p.value=!1)}),l(a(o),{label:"Guardar",icon:"pi pi-check",onClick:X})])]),default:r(()=>[l(a(z),{value:a(F)},{default:r(()=>[l(a(m),{field:"role",header:"Rol"},{body:r(e=>[e.data.role!=="Rector"&&e.data.role!=="SecretarioAcademico"?(c(),b(a(o),{key:0,class:w(x(e.data.role)),textContent:k(e.data.role),onClick:n=>C(e.data.role)},null,8,["class","textContent","onClick"])):R("",!0)]),_:1}),(c(!0),_(U,null,B(a(T),e=>(c(),b(a(m),{field:e,header:e==="registrar"?"Registrar":e==="eliminar"?"Eliminar":"Editar"},{body:r(n=>[n.data.role!=="Administrador"&&n.data.role!=="Rector"&&n.data.role!=="SecretarioAcademico"?(c(),b(a(o),{key:0,class:w(x(n.data.role+"-"+e)),textContent:k(n.data.role+"-"+e),severity:e==="registrar"?"success":e==="eliminar"?"danger":"warning",onClick:j=>C(n.data.role+"-"+e)},null,8,["class","textContent","severity","onClick"])):R("",!0),n.data.role=="Administrador"&&e==="registrar"?(c(),b(a(o),{key:1,class:w(x("Rector")),textContent:"Rector",onClick:t[8]||(t[8]=j=>C("Rector"))},null,8,["class"])):R("",!0),n.data.role=="Administrador"&&e==="eliminar"?(c(),b(a(o),{key:2,class:w(x("SecretarioAcademico")),textContent:"SecretarioAcademico",onClick:t[9]||(t[9]=j=>C("SecretarioAcademico"))},null,8,["class"])):R("",!0)]),_:2},1032,["field","header"]))),256))]),_:1},8,["value"])]),_:1},8,["visible"]),l(a(A),{visible:g.value,"onUpdate:visible":t[12]||(t[12]=e=>g.value=e),header:"Confirmar cambios"},{footer:r(()=>[i("div",we,[l(a(o),{label:"Cancelar",icon:"pi pi-times",onClick:Y}),l(a(o),{label:"Guardar",icon:"pi pi-check",onClick:Z})])]),default:r(()=>[ke]),_:1},8,["visible"])]),_:1}),I("> ")],64))}};export{Me as default};
